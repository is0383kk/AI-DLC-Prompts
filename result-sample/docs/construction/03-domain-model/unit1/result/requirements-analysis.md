# 要件分析書 - Unit1: タスク作成機能

## 作成情報

- **作成日**: 2025-10-22
- **分析対象**: US-001, US-002（タスク作成機能）
- **分析フェーズ**: フェーズ1-1（ユーザーストーリー詳細分析）

## US-001: 新しいタスクの追加 - 詳細分析

### 基本情報
- **ペルソナ**: 田中美咲（メイン）、佐藤健太（サブ）
- **優先度**: High
- **ストーリーポイント**: 3
- **エピック**: EP-001

### 機能要件の詳細分析

#### 主要機能要件
1. **タスク追加トリガー機能**
   - ユーザーが「新しいタスクを追加」ボタンをクリックできる
   - アクション結果として入力フォームが表示される

2. **タスク入力フォーム表示機能**
   - タスク作成のための入力インターフェースを提供する
   - 最小限の入力項目で構成される

3. **タスク保存・永続化機能**
   - 入力されたタスクデータを永続化する
   - 保存成功時の確認メッセージ表示機能

#### 制約条件
- 操作が直感的で学習コストが低いこと
- 思いついたタスクをすぐに記録できること

### 受け入れ基準（AC）の整理

#### AC-001-01: 正常なタスク作成
- **前提条件**: タスク管理アプリの画面が開いている状態
- **実行アクション**: ユーザーが「新しいタスクを追加」ボタンをクリック
- **期待結果**: タスク入力フォームが表示される
- **ビジネス価値**: ユーザーがタスク作成プロセスを開始できる

#### AC-001-02: タスクの保存
- **前提条件**: タスク入力フォームが表示されている状態
- **実行アクション**: タスク名「会議資料の準備」を入力して「保存」ボタンをクリック
- **期待結果**:
  - 新しいタスクがタスク一覧に追加される
  - 「タスクが正常に追加されました」の確認メッセージが表示される
- **ビジネス価値**: タスクの確実な永続化と成功フィードバック

#### AC-001-03: 空白タスク名のバリデーション
- **前提条件**: タスク入力フォームが表示されている状態
- **実行アクション**: タスク名を空白のまま「保存」ボタンをクリック
- **期待結果**:
  - 「タスク名は必須です」のエラーメッセージが表示される
  - タスクは保存されない
- **ビジネス価値**: データ品質の確保とユーザーへの適切なガイダンス

### 抽出されたビジネスルール
1. **BR-001**: タスク名は必須項目である
2. **BR-002**: タスク保存時には確認メッセージを表示する必要がある
3. **BR-003**: バリデーションエラー時は操作を中断し、エラーメッセージを表示する

## US-002: タスクの基本情報入力 - 詳細分析

### 基本情報
- **ペルソナ**: 田中美咲（メイン）
- **優先度**: High
- **ストーリーポイント**: 2
- **エピック**: EP-001

### 機能要件の詳細分析

#### 主要機能要件
1. **最小限入力機能**
   - タスク名のみでタスクを作成できる
   - 他の項目は後から編集可能

2. **入力バリデーション機能**
   - タスク名の文字数制限（100文字以内）
   - 特殊文字の適切な処理

3. **デフォルト値設定機能**
   - 必須でない項目のデフォルト値またはNULL設定

#### 制約条件
- 業務中に発生したタスクをすぐに記録できること
- 追加の詳細情報は後から編集できること

### 受け入れ基準（AC）の整理

#### AC-002-01: 最小限の入力でタスク作成
- **前提条件**: タスク入力フォームが表示されている状態
- **実行アクション**: タスク名のみを入力して保存する
- **期待結果**:
  - タスクが正常に作成される
  - 他の項目はデフォルト値またはNULLで保存される
- **ビジネス価値**: 迅速なタスク記録の実現

#### AC-002-02: タスク名の文字数制限
- **前提条件**: タスク入力フォームが表示されている状態
- **実行アクション**: 100文字を超えるタスク名を入力する
- **期待結果**: 「タスク名は100文字以内で入力してください」のエラーメッセージが表示される
- **ビジネス価値**: データ品質の確保とシステム制約の遵守

#### AC-002-03: 特殊文字の入力
- **前提条件**: タスク入力フォームが表示されている状態
- **実行アクション**: タスク名に「<script>」などの特殊文字を入力する
- **期待結果**:
  - 特殊文字がエスケープされて保存される
  - セキュリティ上の問題が発生しない
- **ビジネス価値**: セキュリティリスクの回避

### 抽出されたビジネスルール
1. **BR-004**: タスク名は100文字以内でなければならない
2. **BR-005**: 特殊文字は適切にエスケープ処理されなければならない
3. **BR-006**: 必須でない項目はデフォルト値またはNULLで初期化される

## 統合ビジネスルール一覧

| ルールID | 内容 | 適用箇所 | 優先度 |
|---------|------|---------|--------|
| BR-001 | タスク名は必須項目である | タスク作成全般 | High |
| BR-002 | タスク保存時には確認メッセージを表示する | 成功フィードバック | Medium |
| BR-003 | バリデーションエラー時は操作を中断し、エラーメッセージを表示する | エラーハンドリング | High |
| BR-004 | タスク名は100文字以内でなければならない | 入力バリデーション | High |
| BR-005 | 特殊文字は適切にエスケープ処理されなければならない | セキュリティ処理 | Critical |
| BR-006 | 必須でない項目はデフォルト値またはNULLで初期化される | データ初期化 | Low |

## 機能要件マップ

```
タスク作成機能
├── UI操作層
│   ├── タスク追加ボタン機能
│   └── 入力フォーム表示機能
├── 入力処理層
│   ├── 入力バリデーション機能
│   │   ├── 必須チェック (BR-001, BR-003)
│   │   ├── 文字数制限 (BR-004)
│   │   └── 特殊文字処理 (BR-005)
│   └── デフォルト値設定機能 (BR-006)
├── ビジネスロジック層
│   └── タスク作成処理機能
└── データ永続化層
    ├── タスク保存機能
    └── 成功フィードバック機能 (BR-002)
```

## 非機能要件の含意

### パフォーマンス要件
- タスク作成操作完了時間: 30秒以内（成功指標より）
- タスク作成成功率: 95%以上（成功指標より）

### セキュリティ要件
- 特殊文字の適切なサニタイゼーション（AC-002-03, NFR-03より）
- XSS攻撃の防止

### ユーザビリティ要件
- 直感的で学習コストが低い操作性
- 迅速なタスク記録が可能
- わかりやすいエラーメッセージの表示（AC-COMMON-02より）

### データ要件
- データの永続化（ブラウザリフレッシュ後も保持）（AC-COMMON-03より）
- バリデーションエラーの適切な表示: 100%（成功指標より）

## 次フェーズへの引き継ぎ事項

1. **ドメインエンティティ設計時の考慮点**:
   - Taskエンティティには最低限taskNameが必要
   - 他の属性はオプショナルまたはデフォルト値を持つ

2. **バリデーション設計時の考慮点**:
   - 6つのビジネスルール（BR-001〜BR-006）の実装が必要
   - エラーメッセージの一貫性を保つ

3. **セキュリティ設計時の考慮点**:
   - 入力サニタイゼーション機能が必須
   - XSS防止対策の組み込み

4. **データ設計時の考慮点**:
   - TaskDataInterface仕様との整合性確保
   - 他ユニットとのデータ共有インターフェース設計