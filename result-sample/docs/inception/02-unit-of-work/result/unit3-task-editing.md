# ユニット3: タスク編集機能

## ユニット概要

**ユニット名**: タスク編集機能ユニット
**作成日**: 2025-10-22
**担当チーム**: チーム2
**実装順序**: 3番目（ユニット1、2完了後）

## 責務と境界

### 主要責務
- 既存タスクの変更・状態更新に関する全機能の提供
- タスク内容の編集・保存処理
- タスク状態の変更（完了/未完了）処理
- 編集のキャンセル機能
- 編集完了時の表示ユニットへの通知

### 機能境界
- **含む**: タスクの内容編集、状態更新、編集フォーム管理
- **含まない**: タスクの作成、表示、削除機能
- **入力**: ユニット2から選択されたタスク情報
- **出力**: 更新されたタスクデータ、ユニット2への更新通知

## 含まれるユーザーストーリー

### US-005: タスクの内容編集
**ユーザーストーリー**
> **As a** タスク管理をしたいユーザー（田中美咲）
> **I want** 既存のタスクの内容を編集したい
> **So that** 業務の変更や詳細の追加に対応できる

**詳細**
- **対象ペルソナ**: 田中美咲（メイン）、佐藤健太（サブ）
- **優先度**: High
- **ストーリーポイント**: 3
- **エピック**: EP-003

**補足**
- 編集操作が直感的で迷わない
- 編集内容が確実に保存される

### US-006: タスクの状態更新
**ユーザーストーリー**
> **As a** 営業事務の田中美咲
> **I want** タスクの進行状況を更新したい
> **So that** 昼休みや業務の合間に進捗を管理できる

**詳細**
- **対象ペルソナ**: 田中美咲（メイン）
- **優先度**: Medium
- **ストーリーポイント**: 2
- **エピック**: EP-003

**補足**
- 状態変更は簡単な操作で完了できる
- 変更内容がすぐに反映される

### 合計ストーリーポイント: 5SP

## 受け入れ基準

### US-005の受け入れ基準

#### AC-005-01: タスクの編集モード開始
**Given** タスク詳細画面またはタスク一覧が表示されている
**When** 「編集」ボタンをクリックする
**Then** タスクの編集フォームが表示される
**And** 現在のタスク名が入力フィールドに表示される

#### AC-005-02: タスクの内容更新
**Given** タスクの編集フォームで「会議資料の準備」を「プレゼン資料の作成」に変更した
**When** 「保存」ボタンをクリックする
**Then** タスクの内容が更新される
**And** 「タスクが正常に更新されました」の確認メッセージが表示される
**And** タスク一覧で変更内容が反映される

#### AC-005-03: 編集のキャンセル
**Given** タスクの編集フォームでタスク名を変更した
**When** 「キャンセル」ボタンをクリックする
**Then** 変更内容が破棄される
**And** タスクの詳細画面または一覧画面に戻る
**And** タスクの内容は変更前のまま保持される

### US-006の受け入れ基準

#### AC-006-01: タスク状態の変更
**Given** タスクに「未完了」の状態が設定されている
**When** タスクの状態を「完了」に変更する
**Then** タスクの状態が更新される
**And** 視覚的に完了状態であることがわかる表示になる

#### AC-006-02: 完了タスクの表示
**Given** タスクが完了状態に設定されている
**When** タスク一覧を表示する
**Then** 完了したタスクが他のタスクと区別して表示される
**And** 取り消し線や色の変更などで完了状態が視覚的にわかる

## 他ユニットとの依存関係・インターフェース

### 入力インターフェース

#### TaskSelectionInterface（ユニット2からの入力）
**データ構造**:
- selectedTaskId: string（選択されたタスクID）
- editMode: boolean（編集モード開始フラグ）

**通信方法**: 画面遷移・状態管理経由
**操作フロー**: タスク選択 → 編集画面表示 → 編集フォーム起動

### 出力インターフェース

#### TaskUpdateNotificationInterface（ユニット2への出力）
**データ構造**:
- updatedTaskId: string（更新されたタスクID）
- updateType: string（更新種別：内容変更/状態変更）
- updateResult: boolean（更新成功/失敗）

**通信方法**: イベント通知・表示更新トリガー
**更新フロー**: 編集完了 → 表示更新通知 → 一覧再表示

#### UpdatedTaskDataInterface（データ永続化層への出力）
**データ構造**:
- taskId: string（更新対象のタスクID）
- taskName: string（更新されたタスク名）
- status: string（更新された状態）
- updatedAt: datetime（更新日時）

**通信方法**: データ永続化層経由

### 依存関係
- **上流ユニット**: ユニット2（タスク表示機能）
- **下流ユニット**: ユニット2（更新通知先）
- **依存方向**: ユニット2 → ユニット3 → ユニット2（循環）

## 実装時の注意事項

### 技術的考慮事項
1. **データ整合性**: 編集中の競合状態への対処
2. **バリデーション**: 編集内容の検証ロジック
3. **状態管理**: 編集モードと表示モードの適切な切り替え
4. **通知機能**: ユニット2への確実な更新通知

### 共通受け入れ条件（このユニットに適用）
- **AC-COMMON-02**: エラーハンドリング
- **AC-COMMON-03**: データの永続化
- **AC-COMMON-04**: UI/UXの一貫性
- **AC-NFR-03**: セキュリティ（適切なサニタイゼーション）

### 実装優先順位
1. 基本的なタスク内容編集機能（US-005）
2. タスク状態更新機能（US-006）
3. 編集キャンセル機能
4. ユニット2への更新通知機能

### 前提条件
- ユニット1（タスク作成機能）が完成していること
- ユニット2（タスク表示機能）が完成していること
- TaskSelectionInterface が正常に動作していること

### チーム引き継ぎ事項
- TaskUpdateNotificationInterface の実装詳細をユニット2チームと調整してください
- 編集中の状態管理方法を明確に文書化してください
- データベースの更新処理でのトランザクション管理を考慮してください

## 実装での考慮事項

### ユーザビリティ
- 編集フォームの使いやすさ（田中美咲のペルソナに合わせた直感的な操作）
- 状態変更の視覚的フィードバック
- 編集キャンセル時の確認ダイアログの適切な実装

### パフォーマンス
- 編集保存の応答時間最適化
- 大量のタスクがある場合の編集性能
- リアルタイム表示更新の効率性

### エラー処理
- 同時編集競合の検出と対処
- ネットワークエラー時の編集内容保護
- バリデーションエラーの分かりやすい表示

## 成功指標
- タスク編集成功率: 95%以上
- 編集操作完了時間: 60秒以内
- 状態変更成功率: 100%
- 更新通知送信成功率: 100%
- 編集キャンセル時のデータ保持率: 100%