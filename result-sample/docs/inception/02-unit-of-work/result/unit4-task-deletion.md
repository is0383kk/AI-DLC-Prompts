# ユニット4: タスク削除機能

## ユニット概要

**ユニット名**: タスク削除機能ユニット
**作成日**: 2025-10-22
**担当チーム**: チーム3
**実装順序**: 4番目（最終ユニット）

## 責務と境界

### 主要責務
- タスクの削除・整理に関する全機能の提供
- 個別タスクの安全な削除処理
- 削除確認・キャンセル機能
- 削除後の状態管理と通知
- 完了タスクの整理機能（将来実装）

### 機能境界
- **含む**: タスクの削除、削除確認、削除後処理
- **含まない**: タスクの作成、表示、編集機能
- **入力**: ユニット2から選択されたタスク情報
- **出力**: 削除処理の結果、ユニット2への削除通知

## 含まれるユーザーストーリー

### US-007: 個別タスクの削除
**ユーザーストーリー**
> **As a** タスク管理をしたいユーザー（田中美咲）
> **I want** 不要になったタスクを削除したい
> **So that** タスク一覧をクリーンな状態に保てる

**詳細**
- **対象ペルソナ**: 田中美咲（メイン）、佐藤健太（サブ）
- **優先度**: Medium
- **ストーリーポイント**: 2
- **エピック**: EP-004

**補足**
- 誤削除を防ぐ確認ダイアログがある
- 削除操作が確実に実行される

### US-008: 完了タスクの整理
**ユーザーストーリー**
> **As a** フリーランサーの佐藤健太
> **I want** 案件完了時に関連タスクをまとめて削除したい
> **So that** 新しい案件に集中するためにタスク一覧を整理できる

**詳細**
- **対象ペルソナ**: 佐藤健太（サブ）
- **優先度**: Low
- **ストーリーポイント**: 3
- **エピック**: EP-004

**補足**
- 複数のタスクを選択して一括削除できる（将来的な機能）
- 現時点では個別削除のみ実装

### 合計ストーリーポイント: 5SP（現在実装は2SP）

## 受け入れ基準

### US-007の受け入れ基準

#### AC-007-01: タスク削除の確認ダイアログ
**Given** タスク一覧またはタスク詳細画面が表示されている
**When** 「削除」ボタンをクリックする
**Then** 「本当に削除しますか？」の確認ダイアログが表示される
**And** 「はい」「いいえ」のボタンが表示される

#### AC-007-02: タスクの削除実行
**Given** タスクの削除確認ダイアログが表示されている
**When** 「はい」ボタンをクリックする
**Then** タスクがシステムから完全に削除される
**And** タスク一覧から該当タスクが消える
**And** 「タスクが削除されました」の確認メッセージが表示される

#### AC-007-03: タスク削除のキャンセル
**Given** タスクの削除確認ダイアログが表示されている
**When** 「いいえ」ボタンまたは「×」ボタンをクリックする
**Then** 削除がキャンセルされる
**And** タスクは削除されずに残る
**And** 元の画面に戻る

#### AC-007-04: 削除後の一覧表示
**Given** タスクが1個だけ存在するシステムで
**When** そのタスクを削除する
**Then** タスク一覧に「登録されているタスクがありません」が表示される

### US-008の受け入れ基準

#### AC-008-01: 複数タスクの選択（将来実装）
**Given** タスク一覧に複数の完了済みタスクが表示されている
**When** 複数のタスクを選択する
**Then** 選択されたタスクがハイライト表示される
**And** 「選択したタスクを削除」ボタンが有効になる

*注意: この機能は現在のスコープ外のため、将来的な実装として定義*

#### AC-008-02: 個別削除による整理（現在実装）
**Given** 完了済みのタスクが5個存在している
**When** 各タスクを個別に削除する
**Then** 削除したタスクがタスク一覧から消える
**And** 残りのタスクは正常に表示され続ける

## 他ユニットとの依存関係・インターフェース

### 入力インターフェース

#### TaskDeletionInterface（ユニット2からの入力）
**データ構造**:
- selectedTaskId: string（選択されたタスクID）
- deleteMode: boolean（削除モード開始フラグ）

**通信方法**: 画面遷移・状態管理経由
**操作フロー**: タスク選択 → 削除確認 → 削除実行

### 出力インターフェース

#### TaskDeletionNotificationInterface（ユニット2への出力）
**データ構造**:
- deletedTaskId: string（削除されたタスクID）
- deleteResult: boolean（削除成功/失敗）

**通信方法**: イベント通知・表示更新トリガー
**更新フロー**: 削除完了 → 表示更新通知 → 一覧再表示

#### DeletedTaskDataInterface（データ永続化層への出力）
**データ構造**:
- taskId: string（削除対象のタスクID）
- deleteOperation: string（削除種別）
- deletedAt: datetime（削除日時）

**通信方法**: データ永続化層経由

### 依存関係
- **上流ユニット**: ユニット2（タスク表示機能）
- **下流ユニット**: ユニット2（削除通知先）
- **依存方向**: ユニット2 → ユニット4 → ユニット2（循環）

## 実装時の注意事項

### 技術的考慮事項
1. **データ安全性**: 削除操作の取り消し不可能性への配慮
2. **確認機能**: 誤削除を防ぐ複数段階の確認
3. **参照整合性**: 削除時の関連データの整合性確保
4. **通知機能**: ユニット2への確実な削除通知

### 共通受け入れ条件（このユニットに適用）
- **AC-COMMON-02**: エラーハンドリング
- **AC-COMMON-03**: データの永続化（削除後の状態保持）
- **AC-COMMON-04**: UI/UXの一貫性

### 実装優先順位
1. 基本的な個別タスク削除機能（US-007）
2. 削除確認・キャンセル機能
3. ユニット2への削除通知機能
4. 完了タスク整理機能（US-008、将来実装）

### 前提条件
- ユニット1（タスク作成機能）が完成していること
- ユニット2（タスク表示機能）が完成していること
- TaskDeletionInterface が正常に動作していること

### チーム引き継ぎ事項
- TaskDeletionNotificationInterface の実装詳細をユニット2チームと調整してください
- 削除操作のログ記録方法を明確に文書化してください
- データベースの削除処理でのバックアップ・復旧考慮を検討してください

## 実装での考慮事項

### ユーザビリティ
- 削除確認ダイアログの分かりやすい表示
- 削除操作の取り消し不可能性の明確な警告
- 削除完了時の適切なフィードバック

### セキュリティ
- 不正な削除要求の検証
- 削除権限の確認（将来の機能拡張時）
- 削除操作のログ記録

### パフォーマンス
- 削除処理の応答時間最適化
- 大量タスク削除時のシステム負荷考慮
- 削除後の表示更新の効率性

### エラー処理
- 削除対象タスクが存在しない場合の処理
- ネットワークエラー時の削除処理の安全性
- 削除失敗時のユーザーへの適切な通知

## 将来実装予定機能

### US-008完全実装（v1.1以降）
- 複数タスクの選択機能
- 一括削除機能
- 削除条件のフィルタリング（完了済みタスクのみ等）
- 削除のアンドゥ機能（一定時間内）

### 拡張機能候補
- 削除済みタスクのゴミ箱機能
- 削除履歴の表示
- 自動削除機能（古いタスクの自動整理）

## 成功指標
- タスク削除成功率: 100%
- 削除確認表示成功率: 100%
- 誤削除防止成功率: 100%（確認ダイアログでのキャンセル機能）
- 削除通知送信成功率: 100%
- 削除後表示更新成功率: 100%